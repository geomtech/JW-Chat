<!DOCTYPE html>
<html lang="fr" class="bg-neutral-100 dark:bg-neutral-900 text-gray-900 dark:text-gray-100 h-fit">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>JW CH.AT</title>
    <meta name="description" content="JW CH.AT">
    <meta name="author" content="JW CH.AT">

    <link rel="icon" href="/static/img/icon.png" type="image/png">

    <link rel="stylesheet" href="/static/css/jw-chat.css">
    <link rel="stylesheet" href="/static/css/jw-chat-custom.css">
    <script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
    <link rel="manifest" href="/static/manifest.webmanifest">
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/static/js/service-worker.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(error) {
                    console.log('ServiceWorker registration failed: ', error);
                });
            });
        }
    </script>
</head>

<body class="bg-neutral-100 dark:bg-neutral-900 text-gray-900 dark:text-gray-100 h-fit">
    <div class="relative h-fit max-w-3xl mx-auto flex flex-col">    
        <div class="sticky top-0 w-full bg-neutral-100 dark:bg-neutral-900 p-2 z-50 flex flex-row justify-between items-center border-b border-neutral-200 dark:border-neutral-800">
            <div class="flex flex-row items-center gap-2">
                <h1 class="text-lg font-bold px-2">JW CH.AT</h1>
            </div>

            <!-- new chat -->
            <button type="button" class="text-white hover:text-gray-200 px-2" onclick="window.location.href='/'">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                    class="size-5">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                </svg>
            </button>
        </div>
        
        <div id="response" class="flex flex-col gap-4 mt-4 p-4 flex-1">
            <div class="hidden flex flex-row gap-2 w-full z-10" id="user-template">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="size-8 text-gray-500 dark:text-gray-400">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
                    <path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855" />
                </svg>
                <div
                    class="flex flex-col w-full bg-neutral-200 dark:bg-neutral-800 text-gray-900 dark:text-gray-100 p-2 rounded-md max-w-prose prose dark:prose-invert shadow-[0_0px_60px_-15px_rgba(0,0,0,0.3)] dark:shadow-[0_0px_60px_-15px_rgba(0,0,0,0.3)] shadow-teal-500/50 dark:shadow-teal-500/50"></div>
            </div>
            
            <div class="hidden flex flex-row gap-2 w-full z-10" id="assistant-template">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-8 text-gray-500 dark:text-gray-400">">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M8 16v-6a2 2 0 1 1 4 0v6" />
                    <path d="M8 13h4" />
                    <path d="M16 8v8" />
                </svg>
                <div
                    class="flex flex-col w-full bg-neutral-200 dark:bg-neutral-800 text-gray-900 dark:text-gray-100 p-2 rounded-md max-w-prose dark:shadow-[0_0px_60px_-15px_rgba(0,0,0,0.3)] dark:shadow-violet-500/50">
                    <div class="response prose dark:prose-invert"></div>
                    <div class="links"></div>
                </div>
            </div>
        </div>

        <div class="my-2">
            <span id="status" class="text-xs text-gray-500 max-w-prose px-2"></span>
            <div class="flex my-10 invisible" id="loading">
                <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div>
            </div>
        </div>

        <form id="question-form" class="fixed bottom-8 flex flex-col w-full max-w-3xl space-y-4 rounded-t-md p-4 bg-transparent dark:bg-transparent z-50">
            <div class="rounded-3xl flex flex-row items-center gap-2 bg-gradient-to-r from-pink-500 via-red-500 to-teal-500 p-px">
                <div class="relative flex-grow bg-neutral-50 dark:bg-neutral-800 rounded-3xl py-1 px-2 z-30 shadow-[0_0px_60px_-15px_rgba(0,0,0,0.3)] dark:shadow-[0_0px_60px_-15px_rgba(0,0,0,0.3)] shadow-teal-500/50 dark:shadow-teal-500/50">
                    <div contenteditable="true" role="textbox" aria-multiline="true" id="user-input" class="flex-grow max-w-full break-all text-black p-2 dark:text-white outline-none z-50 pr-8"></div>
                    <div class="absolute top-1 left-2 p-2 text-gray-500 z-20 pointer-events-none" id="user-input-placeholder">Message JW CH.AT</div>
                    <button type="submit" class="absolute right-0 top-0 mt-px p-2 bg-gradient-to-tr from-neutral-800 to-neutral-600 text-gray-200 rounded-full hover:text-white z-50 my-auto -mr-1">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-7 my-px shrink-0">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                            <path d="M10 14l11 -11" />
                            <path d="M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5" />
                        </svg>
                    </button>
                </div>                
            </div>
        </form>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="/static/js/jw-chat.js"></script>
</body>

</html>
